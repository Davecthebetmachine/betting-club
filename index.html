<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Punter Club</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #0f172a; color: #f8fafc; font-family: -apple-system, system-ui, sans-serif; }
        .ios-card { background: #1e293b; border-radius: 16px; }
        .tab-active { border-bottom: 3px solid #eab308; color: #eab308; font-weight: bold; }
        .hidden { display: none; }
    </style>
</head>
<body class="pb-10">

    <header class="text-center py-8 bg-slate-900 border-b border-slate-800">
        <h1 class="text-xs uppercase tracking-widest text-slate-400 font-semibold">Total Club Bankroll</h1>
        <div id="bankroll" class="text-5xl font-black text-yellow-500 mt-1">$0.00</div>
    </header>

    <nav class="flex bg-slate-900 sticky top-0 z-10 border-b border-slate-800">
        <button id="btn-pot" onclick="showTab('pot')" class="flex-1 py-4 text-sm uppercase tracking-wider tab-active">The Pot</button>
        <button id="btn-bets" onclick="showTab('bets')" class="flex-1 py-4 text-sm uppercase tracking-wider text-slate-400">Bet History</button>
    </nav>

    <main class="p-4 max-w-md mx-auto">
        
        <section id="tab-pot">
            <div class="ios-card p-5">
                <h2 class="text-xs font-bold uppercase text-slate-500 mb-4">Member Contributions</h2>
                <div id="members-list" class="space-y-4">
                    </div>
            </div>
        </section>

        <section id="tab-bets" class="hidden">
            <div class="flex justify-between items-center mb-4 px-2">
                <h2 class="text-xs font-bold uppercase text-slate-500">Live & Settled Bets</h2>
                <button onclick="logBet()" class="bg-yellow-600 text-slate-900 px-3 py-1 rounded-full text-xs font-bold">+ LOG BET</button>
            </div>
            <div id="activity-log" class="space-y-3">
                </div>
        </section>

    </main>

    <script>
        // --- CONFIGURATION ---
        const SCRIPT_URL = "INSERT_YOUR_GOOGLE_SCRIPT_URL_HERE";
        
        let members = [
            { name: "David C", paid: 0 }, { name: "Dean C", paid: 0 },
            { name: "Ash T", paid: 0 }, { name: "Andrew NF", paid: 0 },
            { name: "Mike F", paid: 0 }, { name: "Adam P", paid: 0 },
            { name: "Ryan R", paid: 0 }
        ];
        let totalBets = 0;

        // --- TAB LOGIC ---
        function showTab(tab) {
            if (tab === 'pot') {
                document.getElementById('tab-pot').classList.remove('hidden');
                document.getElementById('tab-bets').classList.add('hidden');
                document.getElementById('btn-pot').classList.add('tab-active');
                document.getElementById('btn-bets').classList.remove('tab-active');
                document.getElementById('btn-bets').classList.add('text-slate-400');
            } else {
                document.getElementById('tab-pot').classList.add('hidden');
                document.getElementById('tab-bets').classList.remove('hidden');
                document.getElementById('btn-bets').classList.add('tab-active');
                document.getElementById('btn-pot').classList.remove('tab-active');
                document.getElementById('btn-pot').classList.add('text-slate-400');
            }
        }

        // --- DATA LOGIC ---
        async function syncToSheets(member, action, amount, note) {
            if (SCRIPT_URL.includes("INSERT_YOUR")) return; 
            try {
                await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: JSON.stringify({ member, action, amount, note })
                });
            } catch (e) { console.error("Sync error:", e); }
        }

        function updateUI() {
            // Update Members List
            const list = document.getElementById('members-list');
            list.innerHTML = members.map((m, i) => `
                <div class="flex justify-between items-center border-b border-slate-700/50 pb-3">
                    <span class="font-semibold text-slate-200">${m.name}</span>
                    <div class="flex items-center gap-4">
                        <span class="font-mono text-green-400 font-bold">$${m.paid}</span>
                        <button onclick="addCash(${i})" class="bg-slate-700 active:bg-slate-600 px-3 py-1 rounded text-[10px] font-bold uppercase tracking-tighter">Add</button>
                    </div>
                </div>
            `).join('');

            // Update Total Bankroll
            const totalIn = members.reduce((s, m) => s + m.paid, 0);
            document.getElementById('bankroll').innerText = `$${(totalIn - totalBets).toFixed(2)}`;
        }

        function addCash(idx) {
            const amt = parseFloat(prompt(`Deposit for ${members[idx].name}:`));
            if (!isNaN(amt)) {
                members[idx].paid += amt;
                syncToSheets(members[idx].name, "DEPOSIT", amt, "Paid into pot");
                updateUI();
            }
        }

        function logBet() {
            const desc = prompt("Bet Details (e.g. Liverpool Win):");
            const amt = parseFloat(prompt("Stake Amount:"));
            if (desc && !isNaN(amt)) {
                totalBets += amt;
                const log = document.getElementById('activity-log');
                if (log.innerHTML.includes("No recent")) log.innerHTML = '';
                
                const betHtml = `
                    <div class="ios-card p-4 border-l-4 border-yellow-500 flex justify-between items-center">
                        <div>
                            <div class="font-bold text-slate-200">${desc}</div>
                            <div class="text-[10px] text-slate-500 uppercase">${new Date().toLocaleDateString()}</div>
                        </div>
                        <div class="text-red-400 font-bold">-$${amt.toFixed(2)}</div>
                    </div>`;
                log.innerHTML = betHtml + log.innerHTML;
                
                syncToSheets("CLUB", "BET", amt, desc);
                updateUI();
            }
        }

        // Initialize
        updateUI();
        if ('serviceWorker' in navigator) { navigator.serviceWorker.register('sw.js'); }
    </script>
</body>
</html>
